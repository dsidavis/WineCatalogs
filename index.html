<html>
    <body>

<h2>Overview</h2>

<b>Goal:</b> Turn scanned images of catalogs from the fine wine and spirit store Sherry-Lehmann into structured data.

<br>

<b>Are we doing anything else?</b>

Yes. Learning about optical character recognition (OCR) and publicly available OCR tools (including tuning them), comparing different OCR engines and potentially combinining their results, developing metrics to measure OCR performance in this context, and, last but not least, building collaborative data science skills.

<h2>Background Information</h2>
<ul>	
<li> <a href="https://www.library.ucdavis.edu/news/whowhat-is-sherry-lehmann/">Background</a>
<li> <a href="https://www.sherry-lehmann.com/about-sherry-lehmann-wine-and-spirits">Sherry Lehmann</a>
<li> <a href="https://ptv.library.ucdavis.edu/">Price the Vintage app.</a>
</ul>

In this collection, there are
<ul>
    <li> 212 catalogs (as PDF files)
    <li> from 1938, 1941, and 1947 to 1988 (most years with multiple catalogs)
    <li> with a total of 4101 pages
    <li> 4111 images as both JPG and DNG files.
    <li> The images are 6000 x 4000.
    <li> The collection of JPEGs is 45Gb, for 4111 images.
</ul>



<h2>Sample Page</h2>

<a href="UCD_Lehmann_0036.jpg" target="window"><img src="UCD_Lehmann_0036.jpg" width=100 height=100></img></a>

<br> Items for sale are usually organized in tables,
but the layout of the tables changes from catalog to catalog or even page to page.
This makes our job fun.

<h2>To Recover</h2>
Some or all of the following characteristics for each beverage (wine, spirit, champagne, etc.):
<ul>
<li> The name of the wine/beverage
<li> Price by bottle and by case.
<li> Color (red, white, rose, ...)
<li> Variety of wine
<li> Country, Region, etc.
<li> Description if possible.
<li> Wine and liquor (not just wine)
</ul>

You may want to start with name and price, which are the most consistently available fields.


<h2>Metadata</h2><a id="metadata"></a>

In this <a href="Sherry Lehmann Crosswalk Page to Catalog.xlsx">spreadsheet</a>,
connecting pages to catalogs to JPG files, which pages have prices, etc.

<ul>
    <li> The page_xwalk tab connects image file names to page and catalogs IDs and catalog page numbers. </li>
    <li> The catalogs and pages tabs have additional data organized by ID, such as the catalog titles. <!--which pages have prices (where is this?) --> </li>
    <li> The marks tab refers to data that has been crowd-sourced for accuracy and can be used for training. It is a small set though, only 1343 entries where each refers to one item, not one box or table </li>
</ul>


<h2>Data</h2>	
	<ul>
	    <li>
	<a href="SampleCatalogPages.tar.bz2">A sample of 100</a> of the 4111 pages of the catalogs. This is  a bz2 tar archive. (Ask if you don't know what this means or how to deal with it.)
	<li> <a href="Half.tar.bz2">Half-resolution.tar.bz2</a>The same 100 images, but at 3000x2000 resolution.

<br>
<h3>Processed Data</h3>

    <li> <a href="FullBoxes.rds">tesseract results from 100 Sample images</a>  This is an R RDS file (use readRDS()) containing the result of calling GetBoxes() in the Rtesseract package on each of the 100 images in the original sample.
	<li> <a href="SampleCatalogFiles_docx.tar.gz">DOCX files from PDFPenPro</a> The docx files from converting the jpegs in the original sample of 100 images using PDFPenPro, a commercial OCR program. Not all images were succesfully converted so some are not present in this archive.


	</ul>



<h3>Additional Data</h3>
The following are other archives each of  100 images from the 4111.
They should not contain any files in common. 
These are here so that you can download and work with smaller files rather than
the entire 45Gbs of images.
Each is about 1.1Gb.

<table>
<tr><th>JPEGs</th><th>Tesseract Results (list of R data frames)</th></tr>
<tr><td><a href="Sample1.tar.bz2">Sample 1</a></td><td><a href="Sample1.rds">Sample 1 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample2.tar.bz2">Sample 2</a></td><td><a href="Sample2.rds">Sample 2 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample3.tar.bz2">Sample 3</a></td><td><a href="Sample3.rds">Sample 3 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample4.tar.bz2">Sample 4</a></td><td><a href="Sample4.rds">Sample 4 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample5.tar.bz2">Sample 5</a></td><td><a href="Sample5.rds">Sample 5 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample6.tar.bz2">Sample 6</a></td><td><a href="Sample6.rds">Sample 6 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample7.tar.bz2">Sample 7</a></td><td><a href="Sample7.rds">Sample 7 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample8.tar.bz2">Sample 8</a></td><td><a href="Sample8.rds">Sample 8 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample9.tar.bz2">Sample 9</a></td><td><a href="Sample9.rds">Sample 9 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample10.tar.bz2">Sample 10</a></td><td><a href="Sample10.rds">Sample 10 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample11.tar.bz2">Sample 11</a></td><td><a href="Sample11.rds">Sample 11 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample12.tar.bz2">Sample 12</a></td><td><a href="Sample12.rds">Sample 12 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample13.tar.bz2">Sample 13</a></td><td><a href="Sample13.rds">Sample 13 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample14.tar.bz2">Sample 14</a></td><td><a href="Sample14.rds">Sample 14 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample15.tar.bz2">Sample 15</a></td><td><a href="Sample15.rds">Sample 15 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample16.tar.bz2">Sample 16</a></td><td><a href="Sample16.rds">Sample 16 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample17.tar.bz2">Sample 17</a></td><td><a href="Sample17.rds">Sample 17 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample18.tar.bz2">Sample 18</a></td><td><a href="Sample18.rds">Sample 18 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample19.tar.bz2">Sample 19</a></td><td><a href="Sample19.rds">Sample 19 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample20.tar.bz2">Sample 20</a></td><td><a href="Sample20.rds">Sample 20 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample21.tar.bz2">Sample 21</a></td><td><a href="Sample21.rds">Sample 21 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample22.tar.bz2">Sample 22</a></td><td><a href="Sample22.rds">Sample 22 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample23.tar.bz2">Sample 23</a></td><td><a href="Sample23.rds">Sample 23 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample24.tar.bz2">Sample 24</a></td><td><a href="Sample24.rds">Sample 24 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample25.tar.bz2">Sample 25</a></td><td><a href="Sample25.rds">Sample 25 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample26.tar.bz2">Sample 26</a></td><td><a href="Sample26.rds">Sample 26 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample27.tar.bz2">Sample 27</a></td><td><a href="Sample27.rds">Sample 27 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample28.tar.bz2">Sample 28</a></td><td><a href="Sample28.rds">Sample 28 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample29.tar.bz2">Sample 29</a></td><td><a href="Sample29.rds">Sample 29 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample30.tar.bz2">Sample 30</a></td><td><a href="Sample30.rds">Sample 30 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample31.tar.bz2">Sample 31</a></td><td><a href="Sample31.rds">Sample 31 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample32.tar.bz2">Sample 32</a></td><td><a href="Sample32.rds">Sample 32 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample33.tar.bz2">Sample 33</a></td><td><a href="Sample33.rds">Sample 33 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample34.tar.bz2">Sample 34</a></td><td><a href="Sample34.rds">Sample 34 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample35.tar.bz2">Sample 35</a></td><td><a href="Sample35.rds">Sample 35 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample36.tar.bz2">Sample 36</a></td><td><a href="Sample36.rds">Sample 36 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample37.tar.bz2">Sample 37</a></td><td><a href="Sample37.rds">Sample 37 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample38.tar.bz2">Sample 38</a></td><td><a href="Sample38.rds">Sample 38 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample39.tar.bz2">Sample 39</a></td><td><a href="Sample39.rds">Sample 39 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample40.tar.bz2">Sample 40</a></td><td><a href="Sample40.rds">Sample 40 RDS tesseract results</a></td></tr>
<tr><td><a href="Sample41.tar.bz2">Sample 41</a></td><td><a href="Sample41.rds">Sample 41 RDS tesseract results</a></td></tr>
</table>

<!--

<ul>
<li> <a href="Sample1.tar.bz2">Sample 1</a>  ,&nbsp;&nbsp;  <a href="Sample1.rds">Sample 1 RDS tesseract results</a>
<li> <a href="Sample2.tar.bz2">Sample 2</a>  ,&nbsp;&nbsp;  <a href="Sample2.rds">Sample 2 RDS tesseract results</a>
<li> <a href="Sample3.tar.bz2">Sample 3</a>  ,&nbsp;&nbsp;  <a href="Sample3.rds">Sample 3 RDS tesseract results</a>
<li> <a href="Sample4.tar.bz2">Sample 4</a>  ,&nbsp;&nbsp;  <a href="Sample4.rds">Sample 4 RDS tesseract results</a>
<li> <a href="Sample5.tar.bz2">Sample 5</a>  ,&nbsp;&nbsp;  <a href="Sample5.rds">Sample 5 RDS tesseract results</a>
<li> <a href="Sample6.tar.bz2">Sample 6</a>  ,&nbsp;&nbsp;  <a href="Sample6.rds">Sample 6 RDS tesseract results</a>
<li> <a href="Sample7.tar.bz2">Sample 7</a>  ,&nbsp;&nbsp;  <a href="Sample7.rds">Sample 7 RDS tesseract results</a>
<li> <a href="Sample8.tar.bz2">Sample 8</a>  ,&nbsp;&nbsp;  <a href="Sample8.rds">Sample 8 RDS tesseract results</a>
<li> <a href="Sample9.tar.bz2">Sample 9</a>  ,&nbsp;&nbsp;  <a href="Sample9.rds">Sample 9 RDS tesseract results</a>
<li> <a href="Sample10.tar.bz2">Sample 10</a>,&nbsp;&nbsp;  <a href="Sample10.rds">Sample 10 RDS tesseract results</a>
<li> <a href="Sample11.tar.bz2">Sample 11</a>,&nbsp;&nbsp;  <a href="Sample11.rds">Sample 11 RDS tesseract results</a>
<li> <a href="Sample12.tar.bz2">Sample 12</a>,&nbsp;&nbsp;  <a href="Sample12.rds">Sample 12 RDS tesseract results</a>
<li> <a href="Sample13.tar.bz2">Sample 13</a>,&nbsp;&nbsp;  <a href="Sample13.rds">Sample 13 RDS tesseract results</a>
<li> <a href="Sample14.tar.bz2">Sample 14</a>,&nbsp;&nbsp;  <a href="Sample14.rds">Sample 14 RDS tesseract results</a>
<li> <a href="Sample15.tar.bz2">Sample 15</a>,&nbsp;&nbsp;  <a href="Sample15.rds">Sample 15 RDS tesseract results</a>
<li> <a href="Sample16.tar.bz2">Sample 16</a>,&nbsp;&nbsp;  <a href="Sample16.rds">Sample 16 RDS tesseract results</a>
<li> <a href="Sample17.tar.bz2">Sample 17</a>,&nbsp;&nbsp;  <a href="Sample17.rds">Sample 17 RDS tesseract results</a>
<li> <a href="Sample18.tar.bz2">Sample 18</a>,&nbsp;&nbsp;  <a href="Sample18.rds">Sample 18 RDS tesseract results</a>
<li> <a href="Sample19.tar.bz2">Sample 19</a>,&nbsp;&nbsp;  <a href="Sample19.rds">Sample 19 RDS tesseract results</a>
    <li> <a href="Sample20.tar.bz2">Sample 20</a>,&nbsp;&nbsp;  <a href="Sample20.rds">Sample 20 RDS tesseract results</a>
	-->
	
</ul>


<h2>Things To Consider</h2>

<h3>Pre-processing</h3>

The results from GetBoxes() are from processing the original image.
<ul>
<li>For some images with text in different (light) colors, converting the image
to black and white using an appropriate threshold is necessary to recover the text.
<li>Some scanned images are rotated more than others which can reduce the accuracy of
tesseract's recovered words and can also lead to additional complexities when 
aligning the results.  One can rotate the image before passing it to GetBoxes().
</ul>

<h3>Ground truth / training</h3>

<ul>
<li>As mentioned in the <a href = "#metadata">metadata</a> section there is crowd-sourced "truth" data in the spreadsheet for specific entries for some pages.
<li>We have created <a href="Truth1.tar.gz">"truth" sets for about 40 pages</a>. They may only contain name, price and year information for each item.
</ul>
    </body>
</html>

